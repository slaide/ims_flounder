<!DOCTYPE html>
<html lang="eng">
    <head>
        <title>My schedule</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="./reset.css">
        <link rel="stylesheet" type="text/css" href="./flounder.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    </head>
        <body>
            <!--Navigation menu for users-->
            <nav class="menu">
            <ul>
                <li><a href="overview.html">Book an instrument</a></li>
                <li><a href="#">My Schedule</a></li>
                <li><a href="#">Administrator</a></li>
                <li><a href="maintenance.html">Maintenance</a></li>
            </ul>
            </nav>

            <div class="grid sched">
            <h1 class="overview_title">My Schedule</h1>
            <div id="my_schedule"></div>
            </div>

            <div class="grid sched">
            <h1>Revoke a booking</h1>
            <label for="bookings">Choose a booking:</label>
            <select name="bookings" id="bookings">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            </select>
         </div>
              <script>

               //SSN from storage
               var ssn = localStorage.getItem(ssn);

               function getBookings() {

                  //XML part
                  var xhttp = new XMLHttpRequest();
                  xhttp.open("POST", "/get_personal_schedule", true);
                  xhttp.onreadystatechange = function() {
                     if (this.readyState == 4 && this.status == 200) {
                        var bookings = JSON.parse(this.responseText);

                        //Error handling
                        if (bookings.error) {
                           console.log(error);
                           return;
                        }
                        
                        //Dunno?? 
                        let schedule = document.querySelector('#my_schedule');
                        
                        //Container element for list
                        let container = document.createElement('div');

                        //Make list 
                        let list = document.createElement('ul');

                        //Add to page
                        //document.getElementsByTagName('body')[0].appendChild(container);
                        schedule.appendChild(container);
                        container.appendChild(list); 
                        
                        for (let i = 0; i < bookings.length; i++) {
                        // create an item for each one
                        listItem = document.createElement('li');

                        // Add the item
                        listItem.innerHTML = bookings[i];

                        // Add listItem to the listElement
                        list.appendChild(listItem);
                        }
                     }  
                  };
                  xhttp.send(JSON.stringify({'ssn': ssn}));
               }

               getBookings(); 

              </script>


              </div>
        </body>
</html>
